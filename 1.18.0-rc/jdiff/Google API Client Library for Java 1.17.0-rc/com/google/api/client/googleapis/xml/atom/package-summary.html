<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0-google-v5) on Fri Mar 21 18:10:47 PDT 2014 -->
<title>com.google.api.client.googleapis.xml.atom</title>
<meta name="date" content="2014-03-21">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="com.google.api.client.googleapis.xml.atom";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../com/google/api/client/googleapis/testing/services/protobuf/package-summary.html">Prev Package</a></li>
<li>Next Package</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?com/google/api/client/googleapis/xml/atom/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;com.google.api.client.googleapis.xml.atom</h1>
<div class="docSummary">
<div class="block"><code>com.google.api.client.util.Beta</code> <br/>
 Utilities for Google's Atom XML implementation (see detailed package specification).</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../../com/google/api/client/googleapis/xml/atom/AtomPatchContent.html" title="class in com.google.api.client.googleapis.xml.atom">AtomPatchContent</a></td>
<td class="colLast">
<div class="block"><code>Beta</code> <br/>
 Serializes Atom XML PATCH HTTP content based on the data key/value mapping object for an Atom
 entry.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../../com/google/api/client/googleapis/xml/atom/AtomPatchRelativeToOriginalContent.html" title="class in com.google.api.client.googleapis.xml.atom">AtomPatchRelativeToOriginalContent</a></td>
<td class="colLast">
<div class="block"><code>Beta</code> <br/>
 Serializes an optimal Atom XML PATCH HTTP content based on the data key/value mapping object for
 an Atom entry, by comparing the original value to the patched value.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../../com/google/api/client/googleapis/xml/atom/GoogleAtom.html" title="class in com.google.api.client.googleapis.xml.atom">GoogleAtom</a></td>
<td class="colLast">
<div class="block"><code>Beta</code> <br/>
 Utilities for working with the Atom XML of Google Data APIs.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../../com/google/api/client/googleapis/xml/atom/GoogleAtom.FieldsMask.html" title="class in com.google.api.client.googleapis.xml.atom">GoogleAtom.FieldsMask</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../../com/google/api/client/googleapis/xml/atom/MultiKindFeedParser.html" title="class in com.google.api.client.googleapis.xml.atom">MultiKindFeedParser</a>&lt;T&gt;</td>
<td class="colLast">
<div class="block"><code>Beta</code> <br/>
 GData Atom feed pull parser when the entry class can be computed from the kind.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package com.google.api.client.googleapis.xml.atom Description">Package com.google.api.client.googleapis.xml.atom Description</h2>
<div class="block"><code>com.google.api.client.util.Beta</code> <br/>
 Utilities for Google's Atom XML implementation (see detailed package specification).

 <h2>Package Specification</h2>

 <p>
 User-defined Partial XML data models allow you to defined Plain Old Java Objects (POJO's) to
 define how the library should parse/serialize XML. Each field that should be included must have
 an @<code>com.google.api.client.util.Key</code> annotation. The field can be of any visibility
 (private, package private, protected, or public) and must not be static.
 </p>

 <p>
 The optional value parameter of this @<code>com.google.api.client.util.Key</code> annotation specifies
 the XPath name to use to represent the field. For example, an XML attribute <code>a</code> has an
 XPath name of <code>@a</code>, an XML element <code>&lt;a&gt;</code> has an XPath name of <code>
a
 </code>, and an XML text content has an XPath name of <code>text()</code>. These are named based
 on their usage with the <a
 href="http://code.google.com/apis/gdata/docs/2.0/reference.html#PartialResponse">partial
 response/update syntax</a> for Google API's. If the @<code>com.google.api.client.util.Key</code>
 annotation is missing, the default is to use the Atom XML namespace and the Java field's name as
 the local XML name. By default, the field name is used as the JSON key. Any unrecognized XML is
 normally simply ignored and not stored. If the ability to store unknown keys is important, use
 <code>com.google.api.client.xml.GenericXml</code>.
 </p>

 <p>
 Let's take a look at a typical partial Atom XML album feed from the Picasa Web Albums Data API:
 </p>

 <pre><code>
&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;feed xmlns='http://www.w3.org/2005/Atom'
    xmlns:openSearch='http://a9.com/-/spec/opensearch/1.1/'
    xmlns:gphoto='http://schemas.google.com/photos/2007'&gt;
  &lt;link rel='http://schemas.google.com/g/2005#post'
    type='application/atom+xml'
    href='http://picasaweb.google.com/data/feed/api/user/liz' /&gt;
  &lt;author&gt;
    &lt;name&gt;Liz&lt;/name&gt;
  &lt;/author&gt;
  &lt;openSearch:totalResults&gt;1&lt;/openSearch:totalResults&gt;
  &lt;entry gd:etag='"RXY8fjVSLyp7ImA9WxVVGE8KQAE."'&gt;
    &lt;category scheme='http://schemas.google.com/g/2005#kind'
      term='http://schemas.google.com/photos/2007#album' /&gt;
    &lt;title&gt;lolcats&lt;/title&gt;
    &lt;summary&gt;Hilarious Felines&lt;/summary&gt;
    &lt;gphoto:access&gt;public&lt;/gphoto:access&gt;
  &lt;/entry&gt;
&lt;/feed&gt;
</code></pre>

 <p>
 Here's one possible way to design the Java data classes for this (each class in its own Java
 file):
 </p>

 <pre><code>
import com.google.api.client.util.*;
import java.util.List;

  public class Link {

    &#64;Key("&#64;href")
    public String href;

    &#64;Key("&#64;rel")
    public String rel;

    public static String find(List&lt;Link&gt; links, String rel) {
      if (links != null) {
        for (Link link : links) {
          if (rel.equals(link.rel)) {
            return link.href;
          }
        }
      }
      return null;
    }
  }

  public class Category {

    &#64;Key("&#64;scheme")
    public String scheme;

    &#64;Key("&#64;term")
    public String term;

    public static Category newKind(String kind) {
      Category category = new Category();
      category.scheme = "http://schemas.google.com/g/2005#kind";
      category.term = "http://schemas.google.com/photos/2007#" + kind;
      return category;
    }
  }

  public class AlbumEntry {

    &#64;Key
    public String summary;

    &#64;Key
    public String title;

    &#64;Key("gphoto:access")
    public String access;

    public Category category = newKind("album");

    private String getEditLink() {
      return Link.find(links, "edit");
    }
  }

  public class Author {

    &#64;Key
    public String name;
  }

  public class AlbumFeed {

    &#64;Key
    public Author author;

    &#64;Key("openSearch:totalResults")
    public int totalResults;

    &#64;Key("entry")
    public List&lt;AlbumEntry&gt; photos;

    &#64;Key("link")
    public List&lt;Link&gt; links;

    private String getPostLink() {
      return Link.find(links, "http://schemas.google.com/g/2005#post");
    }
  }
</code></pre>

 <p>
 You can also use the @<code>com.google.api.client.util.Key</code> annotation to defined query
 parameters for a URL. For example:
 </p>

 <pre><code>
public class PicasaUrl extends GoogleUrl {

  &#64;Key("max-results")
  public Integer maxResults;

  &#64;Key
  public String kinds;

  public PicasaUrl(String url) {
    super(url);
  }

  public static PicasaUrl fromRelativePath(String relativePath) {
    PicasaUrl result = new PicasaUrl(PicasaWebAlbums.ROOT_URL);
    result.path += relativePath;
    return result;
  }
}
</code></pre>

 <p>
 To work with a Google API, you first need to set up the
 <code>com.google.api.client.http.HttpTransport</code>. For example:
 </p>

 <pre><code>
  private static HttpTransport setUpTransport() throws IOException {
    HttpTransport result = new NetHttpTransport();
    GoogleUtils.useMethodOverride(result);
    HttpHeaders headers = new HttpHeaders();
    headers.setApplicationName("Google-PicasaSample/1.0");
    headers.gdataVersion = "2";
    AtomParser parser = new AtomParser();
    parser.namespaceDictionary = PicasaWebAlbumsAtom.NAMESPACE_DICTIONARY;
    transport.addParser(parser);
    // insert authentication code...
    return transport;
  }
</code></pre>

 <p>
 Now that we have a transport, we can execute a partial GET request to the Picasa Web Albums API
 and parse the result:
 </p>

 <pre><code>
  public static AlbumFeed executeGet(HttpTransport transport, PicasaUrl url)
      throws IOException {
    url.fields = GoogleAtom.getFieldsFor(AlbumFeed.class);
    url.kinds = "photo";
    url.maxResults = 5;
    HttpRequest request = transport.buildGetRequest();
    request.url = url;
    return request.execute().parseAs(AlbumFeed.class);
  }
</code></pre>

 <p>
 If the server responds with an error the <code>com.google.api.client.http.HttpRequest#execute</code>
 method will throw an <code>com.google.api.client.http.HttpResponseException</code>, which has an
 <code>com.google.api.client.http.HttpResponse</code> field which can be parsed the same way as a
 success response inside of a catch block. For example:
 </p>

 <pre><code>
    try {
...
    } catch (HttpResponseException e) {
      if (e.response.getParser() != null) {
        Error error = e.response.parseAs(Error.class);
        // process error response
      } else {
        String errorContentString = e.response.parseAsString();
        // process error response as string
      }
      throw e;
    }
</code></pre>

 <p>
 To update an album, we use the transport to execute an efficient partial update request using the
 PATCH method to the Picasa Web Albums API:
 </p>

 <pre><code>
  public AlbumEntry executePatchRelativeToOriginal(HttpTransport transport,
      AlbumEntry original) throws IOException {
    HttpRequest request = transport.buildPatchRequest();
    request.setUrl(getEditLink());
    request.headers.ifMatch = etag;
    AtomPatchRelativeToOriginalContent content =
        new AtomPatchRelativeToOriginalContent();
    content.namespaceDictionary = PicasaWebAlbumsAtom.NAMESPACE_DICTIONARY;
    content.originalEntry = original;
    content.patchedEntry = this;
    request.content = content;
    return request.execute().parseAs(AlbumEntry.class);
  }

  private static AlbumEntry updateTitle(HttpTransport transport,
      AlbumEntry album) throws IOException {
    AlbumEntry patched = album.clone();
    patched.title = "An alternate title";
    return patched.executePatchRelativeToOriginal(transport, album);
  }
</code></pre>

 <p>
 To insert an album, we use the transport to execute a POST request to the Picasa Web Albums API:
 </p>

 <pre><code>
  public AlbumEntry insertAlbum(HttpTransport transport, AlbumEntry entry)
      throws IOException {
    HttpRequest request = transport.buildPostRequest();
    request.setUrl(getPostLink());
    AtomContent content = new AtomContent();
    content.namespaceDictionary = PicasaWebAlbumsAtom.NAMESPACE_DICTIONARY;
    content.entry = entry;
    request.content = content;
    return request.execute().parseAs(AlbumEntry.class);
  }
</code></pre>

 <p>
 To delete an album, we use the transport to execute a DELETE request to the Picasa Web Albums
 API:
 </p>

 <pre><code>
  public void executeDelete(HttpTransport transport) throws IOException {
    HttpRequest request = transport.buildDeleteRequest();
    request.setUrl(getEditLink());
    request.headers.ifMatch = etag;
    request.execute().ignore();
  }
</code></pre>

 <p>
 NOTE: As you might guess, the library uses reflection to populate the user-defined data model.
 It's not quite as fast as writing the wire format parsing code yourself can potentially be, but
 it's a lot easier.
 </p>

 <p>
 NOTE: If you prefer to use your favorite XML parsing library instead (there are many of them),
 that's supported as well. Just call <code>com.google.api.client.http.HttpRequest#execute()</code> and
 parse the returned byte stream.
 </p></div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>1.0</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Yaniv Inbar</dd></dl>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../com/google/api/client/googleapis/testing/services/protobuf/package-summary.html">Prev Package</a></li>
<li>Next Package</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?com/google/api/client/googleapis/xml/atom/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
